syntax = "proto3";

package users;

service User{
	rpc RequestOtp(OtpRequest) returns (OtpRequestError);
	rpc VerifyOtp(OtpVerifyRequest) returns (OtpVerifyResponse);
}

message Empty{

}

message OtpRequestError{
	oneof err{
		string email=1;
		string phone=2;
	}
}

message OtpRequest{
	oneof id{
		string email=1;
		string phone=2;
	}
}


message OtpVerifyRequest{
	string email_or_phone=1;
	string otp=2;
}

message OtpVerifyResponse{
	oneof res{
		string uuid=1;
		string err_msg=2;
	}
}

message RegistrationRequest{
	string phone_number=1;
	string otp=2;
}

enum RegistrationError{
	INVALID_OTP=0;
	INVALID_PHONE=1;
}

message Token{
	bytes access=1;
	uint32 ttl_seconds=2;
}

message RegistrationResponse{
	oneof data{
		Token token = 1;
		RegistrationError error=2;
	}
}